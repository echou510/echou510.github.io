<pre><tt><b><font color="#006cb8">001: </font></b><font color="#7a9ecd">/**</font>
<b><font color="#006cb8">002: </font></b><font color="#7a9ecd">   This class applies the heapsort algorithm to sort an array.</font>
<b><font color="#006cb8">003: </font></b><font color="#7a9ecd">*/</font>
<b><font color="#006cb8">004: </font></b><font color="#d05b76">public</font> <font color="#d05b76">class</font> <font color="#000000">HeapSorter</font>
<b><font color="#006cb8">005: </font></b><font color="#000000">{</font>
<b><font color="#006cb8">006: </font></b>   <font color="#7a9ecd">/**</font>
<b><font color="#006cb8">007: </font></b><font color="#7a9ecd">      Constructs a heap sorter that sorts a given array.</font>
<b><font color="#006cb8">008: </font></b><font color="#7a9ecd">      @param anArray an array of integers</font>
<b><font color="#006cb8">009: </font></b><font color="#7a9ecd">   */</font>
<b><font color="#006cb8">010: </font></b>   <font color="#d05b76">public</font> <font color="#000000">HeapSorter</font><font color="#000000">(</font><font color="#d05b76">int</font><font color="#000000">[</font><font color="#000000">]</font> <font color="#000000">anArray</font><font color="#000000">)</font>
<b><font color="#006cb8">011: </font></b>   <font color="#000000">{</font>
<b><font color="#006cb8">012: </font></b>      <font color="#000000">a</font> <font color="#000000">=</font> <font color="#000000">anArray</font><font color="#000000">;</font>
<b><font color="#006cb8">013: </font></b>   <font color="#000000">}</font>   
<b><font color="#006cb8">014: </font></b>
<b><font color="#006cb8">015: </font></b>   <font color="#7a9ecd">/**</font>
<b><font color="#006cb8">016: </font></b><font color="#7a9ecd">      Sorts the array managed by this heap sorter.</font>
<b><font color="#006cb8">017: </font></b><font color="#7a9ecd">   */</font>
<b><font color="#006cb8">018: </font></b>   <font color="#d05b76">public</font> <font color="#d05b76">void</font> <font color="#000000">sort</font><font color="#000000">(</font><font color="#000000">)</font>
<b><font color="#006cb8">019: </font></b>   <font color="#000000">{</font>  
<b><font color="#006cb8">020: </font></b>      <font color="#d05b76">int</font> <font color="#000000">n</font> <font color="#000000">=</font> <font color="#000000">a</font><font color="#000000">.</font><font color="#000000">length</font> <font color="#000000">-</font> <font color="#89c976">1</font><font color="#000000">;</font>
<b><font color="#006cb8">021: </font></b>      <font color="#d05b76">for</font> <font color="#000000">(</font><font color="#d05b76">int</font> <font color="#000000">i</font> <font color="#000000">=</font> <font color="#000000">(</font><font color="#000000">n</font> <font color="#000000">-</font> <font color="#89c976">1</font><font color="#000000">)</font> <font color="#000000">/</font> <font color="#89c976">2</font><font color="#000000">;</font> <font color="#000000">i</font> <font color="#000000">&gt;</font><font color="#000000">=</font> <font color="#89c976">0</font><font color="#000000">;</font> <font color="#000000">i</font><font color="#000000">-</font><font color="#000000">-</font><font color="#000000">)</font>
<b><font color="#006cb8">022: </font></b>         <font color="#000000">fixHeap</font><font color="#000000">(</font><font color="#000000">i</font><font color="#000000">,</font> <font color="#000000">n</font><font color="#000000">)</font><font color="#000000">;</font>
<b><font color="#006cb8">023: </font></b>      <font color="#d05b76">while</font> <font color="#000000">(</font><font color="#000000">n</font> <font color="#000000">&gt;</font> <font color="#89c976">0</font><font color="#000000">)</font>
<b><font color="#006cb8">024: </font></b>      <font color="#000000">{</font>
<b><font color="#006cb8">025: </font></b>         <font color="#000000">swap</font><font color="#000000">(</font><font color="#89c976">0</font><font color="#000000">,</font> <font color="#000000">n</font><font color="#000000">)</font><font color="#000000">;</font>
<b><font color="#006cb8">026: </font></b>         <font color="#000000">n</font><font color="#000000">-</font><font color="#000000">-</font><font color="#000000">;</font>
<b><font color="#006cb8">027: </font></b>         <font color="#000000">fixHeap</font><font color="#000000">(</font><font color="#89c976">0</font><font color="#000000">,</font> <font color="#000000">n</font><font color="#000000">)</font><font color="#000000">;</font>
<b><font color="#006cb8">028: </font></b>      <font color="#000000">}</font>
<b><font color="#006cb8">029: </font></b>   <font color="#000000">}</font>
<b><font color="#006cb8">030: </font></b>
<b><font color="#006cb8">031: </font></b>   <font color="#7a9ecd">/**</font>
<b><font color="#006cb8">032: </font></b><font color="#7a9ecd">      Ensures the heap property for a subtree, provided its</font>
<b><font color="#006cb8">033: </font></b><font color="#7a9ecd">      children already fulfill the heap property.</font>
<b><font color="#006cb8">034: </font></b><font color="#7a9ecd">      @param rootIndex the index of the subtree to be fixed</font>
<b><font color="#006cb8">035: </font></b><font color="#7a9ecd">      @param lastIndex the last valid index of the tree that </font>
<b><font color="#006cb8">036: </font></b><font color="#7a9ecd">      contains the subtree to be fixed</font>
<b><font color="#006cb8">037: </font></b><font color="#7a9ecd">   */</font>
<b><font color="#006cb8">038: </font></b>   <font color="#d05b76">private</font> <font color="#d05b76">void</font> <font color="#000000">fixHeap</font><font color="#000000">(</font><font color="#d05b76">int</font> <font color="#000000">rootIndex</font><font color="#000000">,</font> <font color="#d05b76">int</font> <font color="#000000">lastIndex</font><font color="#000000">)</font>
<b><font color="#006cb8">039: </font></b>   <font color="#000000">{</font>
<b><font color="#006cb8">040: </font></b>      <font color="#7a9ecd">// Remove root</font>
<b><font color="#006cb8">041: </font></b>      <font color="#d05b76">int</font> <font color="#000000">rootValue</font> <font color="#000000">=</font> <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">rootIndex</font><font color="#000000">]</font><font color="#000000">;</font>
<b><font color="#006cb8">042: </font></b>
<b><font color="#006cb8">043: </font></b>      <font color="#7a9ecd">// Promote children while they are larger than the root      </font>
<b><font color="#006cb8">044: </font></b>
<b><font color="#006cb8">045: </font></b>      <font color="#d05b76">int</font> <font color="#000000">index</font> <font color="#000000">=</font> <font color="#000000">rootIndex</font><font color="#000000">;</font>
<b><font color="#006cb8">046: </font></b>      <font color="#d05b76">boolean</font> <font color="#000000">more</font> <font color="#000000">=</font> <font color="#d05b76">true</font><font color="#000000">;</font>
<b><font color="#006cb8">047: </font></b>      <font color="#d05b76">while</font> <font color="#000000">(</font><font color="#000000">more</font><font color="#000000">)</font>
<b><font color="#006cb8">048: </font></b>      <font color="#000000">{</font>
<b><font color="#006cb8">049: </font></b>         <font color="#d05b76">int</font> <font color="#000000">childIndex</font> <font color="#000000">=</font> <font color="#000000">getLeftChildIndex</font><font color="#000000">(</font><font color="#000000">index</font><font color="#000000">)</font><font color="#000000">;</font>
<b><font color="#006cb8">050: </font></b>         <font color="#d05b76">if</font> <font color="#000000">(</font><font color="#000000">childIndex</font> <font color="#000000">&lt;</font><font color="#000000">=</font> <font color="#000000">lastIndex</font><font color="#000000">)</font>
<b><font color="#006cb8">051: </font></b>         <font color="#000000">{</font>
<b><font color="#006cb8">052: </font></b>            <font color="#7a9ecd">// Use right child instead if it is larger</font>
<b><font color="#006cb8">053: </font></b>            <font color="#d05b76">int</font> <font color="#000000">rightChildIndex</font> <font color="#000000">=</font> <font color="#000000">getRightChildIndex</font><font color="#000000">(</font><font color="#000000">index</font><font color="#000000">)</font><font color="#000000">;</font>
<b><font color="#006cb8">054: </font></b>            <font color="#d05b76">if</font> <font color="#000000">(</font><font color="#000000">rightChildIndex</font> <font color="#000000">&lt;</font><font color="#000000">=</font> <font color="#000000">lastIndex</font>
<b><font color="#006cb8">055: </font></b>                  <font color="#000000">&amp;</font><font color="#000000">&amp;</font> <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">rightChildIndex</font><font color="#000000">]</font> <font color="#000000">&gt;</font> <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">childIndex</font><font color="#000000">]</font><font color="#000000">)</font>
<b><font color="#006cb8">056: </font></b>            <font color="#000000">{</font>
<b><font color="#006cb8">057: </font></b>               <font color="#000000">childIndex</font> <font color="#000000">=</font> <font color="#000000">rightChildIndex</font><font color="#000000">;</font>
<b><font color="#006cb8">058: </font></b>            <font color="#000000">}</font>
<b><font color="#006cb8">059: </font></b>            
<b><font color="#006cb8">060: </font></b>            <font color="#d05b76">if</font> <font color="#000000">(</font><font color="#000000">a</font><font color="#000000">[</font><font color="#000000">childIndex</font><font color="#000000">]</font> <font color="#000000">&gt;</font> <font color="#000000">rootValue</font><font color="#000000">)</font> 
<b><font color="#006cb8">061: </font></b>            <font color="#000000">{</font>
<b><font color="#006cb8">062: </font></b>               <font color="#7a9ecd">// Promote child</font>
<b><font color="#006cb8">063: </font></b>               <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#000000">=</font> <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">childIndex</font><font color="#000000">]</font><font color="#000000">;</font>
<b><font color="#006cb8">064: </font></b>               <font color="#000000">index</font> <font color="#000000">=</font> <font color="#000000">childIndex</font><font color="#000000">;</font>
<b><font color="#006cb8">065: </font></b>            <font color="#000000">}</font>
<b><font color="#006cb8">066: </font></b>            <font color="#d05b76">else</font>
<b><font color="#006cb8">067: </font></b>            <font color="#000000">{</font>
<b><font color="#006cb8">068: </font></b>               <font color="#7a9ecd">// Root value is larger than both children</font>
<b><font color="#006cb8">069: </font></b>               <font color="#000000">more</font> <font color="#000000">=</font> <font color="#d05b76">false</font><font color="#000000">;</font>
<b><font color="#006cb8">070: </font></b>            <font color="#000000">}</font>
<b><font color="#006cb8">071: </font></b>         <font color="#000000">}</font>
<b><font color="#006cb8">072: </font></b>         <font color="#d05b76">else</font> 
<b><font color="#006cb8">073: </font></b>         <font color="#000000">{</font>
<b><font color="#006cb8">074: </font></b>            <font color="#7a9ecd">// No children</font>
<b><font color="#006cb8">075: </font></b>            <font color="#000000">more</font> <font color="#000000">=</font> <font color="#d05b76">false</font><font color="#000000">;</font> 
<b><font color="#006cb8">076: </font></b>         <font color="#000000">}</font>
<b><font color="#006cb8">077: </font></b>      <font color="#000000">}</font>
<b><font color="#006cb8">078: </font></b>
<b><font color="#006cb8">079: </font></b>      <font color="#7a9ecd">// Store root value in vacant slot</font>
<b><font color="#006cb8">080: </font></b>      <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#000000">=</font> <font color="#000000">rootValue</font><font color="#000000">;</font>
<b><font color="#006cb8">081: </font></b>   <font color="#000000">}</font>
<b><font color="#006cb8">082: </font></b>
<b><font color="#006cb8">083: </font></b>   <font color="#7a9ecd">/**</font>
<b><font color="#006cb8">084: </font></b><font color="#7a9ecd">      Swaps two entries of the array.</font>
<b><font color="#006cb8">085: </font></b><font color="#7a9ecd">      @param i the first position to swap</font>
<b><font color="#006cb8">086: </font></b><font color="#7a9ecd">      @param j the second position to swap</font>
<b><font color="#006cb8">087: </font></b><font color="#7a9ecd">   */</font>
<b><font color="#006cb8">088: </font></b>   <font color="#d05b76">private</font> <font color="#d05b76">void</font> <font color="#000000">swap</font><font color="#000000">(</font><font color="#d05b76">int</font> <font color="#000000">i</font><font color="#000000">,</font> <font color="#d05b76">int</font> <font color="#000000">j</font><font color="#000000">)</font>
<b><font color="#006cb8">089: </font></b>   <font color="#000000">{</font>
<b><font color="#006cb8">090: </font></b>      <font color="#d05b76">int</font> <font color="#000000">temp</font> <font color="#000000">=</font> <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font><font color="#000000">;</font>
<b><font color="#006cb8">091: </font></b>      <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font> <font color="#000000">=</font> <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">j</font><font color="#000000">]</font><font color="#000000">;</font>
<b><font color="#006cb8">092: </font></b>      <font color="#000000">a</font><font color="#000000">[</font><font color="#000000">j</font><font color="#000000">]</font> <font color="#000000">=</font> <font color="#000000">temp</font><font color="#000000">;</font>
<b><font color="#006cb8">093: </font></b>   <font color="#000000">}</font>
<b><font color="#006cb8">094: </font></b>
<b><font color="#006cb8">095: </font></b>   <font color="#7a9ecd">/**</font>
<b><font color="#006cb8">096: </font></b><font color="#7a9ecd">      Returns the index of the left child.</font>
<b><font color="#006cb8">097: </font></b><font color="#7a9ecd">      @param index the index of a node in this heap</font>
<b><font color="#006cb8">098: </font></b><font color="#7a9ecd">      @return the index of the left child of the given node</font>
<b><font color="#006cb8">099: </font></b><font color="#7a9ecd">   */</font>
<b><font color="#006cb8">100: </font></b>   <font color="#d05b76">private</font> <font color="#d05b76">static</font> <font color="#d05b76">int</font> <font color="#000000">getLeftChildIndex</font><font color="#000000">(</font><font color="#d05b76">int</font> <font color="#000000">index</font><font color="#000000">)</font>
<b><font color="#006cb8">101: </font></b>   <font color="#000000">{</font>
<b><font color="#006cb8">102: </font></b>      <font color="#d05b76">return</font> <font color="#89c976">2</font> <font color="#000000">*</font> <font color="#000000">index</font> <font color="#000000">+</font> <font color="#89c976">1</font><font color="#000000">;</font>
<b><font color="#006cb8">103: </font></b>   <font color="#000000">}</font>
<b><font color="#006cb8">104: </font></b>
<b><font color="#006cb8">105: </font></b>   <font color="#7a9ecd">/**</font>
<b><font color="#006cb8">106: </font></b><font color="#7a9ecd">      Returns the index of the right child.</font>
<b><font color="#006cb8">107: </font></b><font color="#7a9ecd">      @param index the index of a node in this heap</font>
<b><font color="#006cb8">108: </font></b><font color="#7a9ecd">      @return the index of the right child of the given node</font>
<b><font color="#006cb8">109: </font></b><font color="#7a9ecd">   */</font>
<b><font color="#006cb8">110: </font></b>   <font color="#d05b76">private</font> <font color="#d05b76">static</font> <font color="#d05b76">int</font> <font color="#000000">getRightChildIndex</font><font color="#000000">(</font><font color="#d05b76">int</font> <font color="#000000">index</font><font color="#000000">)</font>
<b><font color="#006cb8">111: </font></b>   <font color="#000000">{</font>
<b><font color="#006cb8">112: </font></b>      <font color="#d05b76">return</font> <font color="#89c976">2</font> <font color="#000000">*</font> <font color="#000000">index</font> <font color="#000000">+</font> <font color="#89c976">2</font><font color="#000000">;</font>
<b><font color="#006cb8">113: </font></b>   <font color="#000000">}</font>
<b><font color="#006cb8">114: </font></b>
<b><font color="#006cb8">115: </font></b>   <font color="#d05b76">private</font> <font color="#d05b76">int</font><font color="#000000">[</font><font color="#000000">]</font> <font color="#000000">a</font><font color="#000000">;</font>
<b><font color="#006cb8">116: </font></b><font color="#000000">}</font>
</tt></pre>
